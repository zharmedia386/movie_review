{% extends 'main.html' %}
<!--  -->
{% block title %} Movie Review Website {% endblock title %}
<!--  -->
{% block content %}
<!--  -->
{% include 'main_navbar.html' %}
<main class="text-porange flex flex-row justify-between gap-6 p-5">
  <!-- Left Side: Sidebar -->
  <div
    class="hidden lg:flex flex-col gap-2 bg-pLightPurple shadow-md p-5 rounded-lg max-w-xs w-full max-h-[350px]"
  >
    <p class="text-white/80">Sort By</p>
    <!-- Latest and Most Popular -->
    <div class="flex flex-col gap-3">
      <a
        href="?sort=latest"
        class="flex justify-center items-center bg-pgreen/90 text-white p-2 rounded-md font-medium text-center transition-all duration-300 ease-in-out hover:bg-pgreen hover:scale-[98%]"
      >
        <span class="flex gap-3">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="currentColor"
            class="w-6 h-6"
          >
            <path
              fill-rule="evenodd"
              d="M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v6c0 .414.336.75.75.75h4.5a.75.75 0 0 0 0-1.5h-3.75V6Z"
              clip-rule="evenodd"
            />
          </svg>
          Latest Movies
        </span>
      </a>
      <a
        href="?sort=popular"
        class="flex justify-center items-center bg-pred/90 text-white p-2 rounded-md font-medium text-center transition-all duration-300 ease-in-out hover:bg-pred hover:scale-[98%]"
      >
        <span class="flex gap-3">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="currentColor"
            class="w-6 h-6"
          >
            <path
              fill-rule="evenodd"
              d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z"
              clip-rule="evenodd"
            />
          </svg>

          Most Popular
        </span>
      </a>
    </div>
    <!-- Categories -->
    <p class="underline text-white/80 mt-7">Categories</p>
    <div class="flex flex-wrap gap-2">
      <a
        class="py-2 bg-[#8dd3c7] rounded-full text-pgray px-4 transition-all duration-300 ease-in hover:scale-[95%]"
        href="?category=Action"
        >Action</a
      >
      <a
        class="py-2 bg-[#ffffb3] rounded-full text-yellow-700 px-4 transition-all duration-300 ease-in hover:scale-[95%]"
        href="?category=Comedy"
        >Comedy</a
      >
      <a
        class="py-2 bg-[#bebada] rounded-full text-purple-700 px-4 transition-all duration-300 ease-in hover:scale-[95%]"
        href="?category=Sci-Fi"
        >Sci-Fi</a
      >
      <a
        class="py-2 bg-[#fb8072] rounded-full text-white px-4 transition-all duration-300 ease-in hover:scale-[95%]"
        href="?category=Adventure"
        >Adventure</a
      >
      <a
        class="py-2 bg-[#80b1d3] rounded-full text-pgray px-4 transition-all duration-300 ease-in hover:scale-[95%]"
        href="?category=Drama"
        >Drama</a
      >
    </div>
  </div>
  <!-- Right Side -->
  <div class="rounded-sm w-full grid grid-cols-1 md:grid-cols-3 gap-2">
    {% for movie in movies %}
    <!-- Movie Card -->
    <div
      class="flex relative flex-col gap-2 rounded-md bg-pLightPurple w-full p-2 h-[260px] group transition-all ease-in-out duration-500 hover:scale-[102%] hover:shadow-md"
    >
      <!-- Rating -->
      <div
        class="absolute bg-pgreen z-10 top-3 left-3 p-1 text-xs font-semibold text-white rounded-full transition-all ease-in-out duration-500 group-hover:opacity-100 lg:opacity-50 w-fit"
      >
        <p class="flex gap-1 items-center">
          {{ movie.average_rating | floatformat:2 }}

          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="currentColor"
            class="w-4 h-4"
          >
            <path
              fill-rule="evenodd"
              d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.006 5.404.434c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.434 2.082-5.005Z"
              clip-rule="evenodd"
            />
          </svg>
        </p>
      </div>
      <!-- Image -->
      <div
        class="h-3/5 w-full bg-center bg-no-repeat bg-cover rounded-lg lg:grayscale group-hover:grayscale-0 transition-all ease-in duration-500"
        style="background-image: url({{ movie.image.url }})"
      ></div>
      <p class="font-medium text-sm text-white">{{ movie.title }}</p>

      <!-- Newly addes code for number of comments -->
      <div class="flex justify-between">
        <p class="text-xs font-bold text-pgreen">{{ movie.year }}</p>
        <div class="flex text-xs">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            fill="currentColor"
            class="w-4 h-4"
          >
            <path
              d="M4.913 2.658c2.075-.27 4.19-.408 6.337-.408 2.147 0 4.262.139 6.337.408 1.922.25 3.291 1.861 3.405 3.727a4.403 4.403 0 00-1.032-.211 50.89 50.89 0 00-8.42 0c-2.358.196-4.04 2.19-4.04 4.434v4.286a4.47 4.47 0 002.433 3.984L7.28 21.53A.75.75 0 016 21v-4.03a48.527 48.527 0 01-1.087-.128C2.905 16.58 1.5 14.833 1.5 12.862V6.638c0-1.97 1.405-3.718 3.413-3.979z"
            />
            <path
              d="M15.75 7.5c-1.376 0-2.739.057-4.086.169C10.124 7.797 9 9.103 9 10.609v4.285c0 1.507 1.128 2.814 2.67 2.94 1.243.102 2.5.157 3.768.165l2.782 2.781a.75.75 0 001.28-.53v-2.39l.33-.026c1.542-.125 2.67-1.433 2.67-2.94v-4.286c0-1.505-1.125-2.811-2.664-2.94A49.392 49.392 0 0015.75 7.5z"
            />
          </svg>
          <p class="ml-2">{{ movie.reviews.count }}</p>
        </div>
      </div>
      <!-- End of newly addes code for number of comments -->
      <a
        href="{% url 'review' movie.slug movie.id %}"
        class="bg-gradient-to-br from-orangeOne to-orangeTwo text-center text-white w-full p-1 font-medium rounded-full"
      >
        Review
      </a>
    </div>
    {% empty %}
    <p class="underline text-pgreen text-2xl font-bold mt-7">
      There are currently no movies.
    </p>
    {% endfor %}
  </div>
</main>
{% endblock content %}
